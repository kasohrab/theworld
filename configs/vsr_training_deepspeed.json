{
  "_comment": "VSR training with DeepSpeed ZeRO-3 (projection-only by default)",
  "_usage": "deepspeed --num_gpus=4 scripts/train_hf.py --config configs/vsr_training_deepspeed.json",
  "_notes": [
    "Projection-only: Trains only world projection layer (~0.07% params, fast)",
    "Full model: Set freeze_gemma_language=false to train language model (89% params, slower)",
    "For 2 GPUs: Change deepspeed_config to 'configs/deepspeed_zero3_2gpu.json'",
    "For 1 GPU: Change deepspeed_config to 'configs/deepspeed_offload_1gpu.json' (very slow)"
  ],

  "model_name": "google/gemma-3-4b-it",
  "cosmos_model_name": "nvidia/Cosmos-Predict2-2B-Video2World",
  "num_world_steps": 0,
  "max_world_steps": 16,
  "freeze_gemma_vision": true,
  "freeze_gemma_language": true,
  "freeze_cosmos_vae": true,

  "learning_rate": 0.0001,
  "batch_size": 4,
  "gradient_accumulation_steps": 1,
  "num_epochs": 1,
  "warmup_steps": 100,
  "weight_decay": 0.01,
  "max_grad_norm": 1.0,

  "use_gradient_checkpointing": true,
  "mixed_precision": "bf16",
  "deepspeed_config": "configs/deepspeed_zero3_4gpu.json",

  "output_dir": "./checkpoints/theworld-vsr-deepspeed",
  "save_steps": 500,
  "save_total_limit": 3,
  "resume_from_checkpoint": null,

  "eval_steps": 500,
  "eval_batch_size": 8,
  "do_eval": false,

  "logging_steps": 50,
  "log_to_wandb": false,
  "wandb_project": "TheWorld",
  "wandb_run_name": "vsr-full-model-deepspeed",
  "log_to_tensorboard": true,

  "max_seq_length": 2048,
  "num_workers": 4,
  "train_dataset_path": null,
  "eval_dataset_path": null,
  "dataset_name": "vsr",
  "num_samples": null,
  "streaming": false,
  "question_template": "Statement: {caption}\nAnswer (only '0' or '1'):",
  "image_folder": "/home/hice1/ksohrab3/scratch/theworld/data/images",

  "_dataset_info": [
    "VSR (Visual Spatial Reasoning) dataset evaluates spatial understanding",
    "Binary classification task: Model outputs single token (0 or 1)",
    "Label 0 = False statement, Label 1 = True statement",
    "Train split: ~8,777 samples",
    "Validation split: ~1,098 samples",
    "Test split: ~1,097 samples",
    "Images are stored locally and referenced by filename",
    "Question format matches evaluation script for consistency"
  ],

  "hf_token": null,
  "push_to_hub": false,
  "hub_model_id": "your-username/theworld-vsr-full",
  "hub_strategy": "every_save",
  "hub_private_repo": false
}
